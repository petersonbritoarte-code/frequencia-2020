<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Freq 20/20</title>

<style>
:root{--accent:#8bd3ff;color-scheme:dark}
body{
margin:0;background:#000;
font-family:system-ui;
display:flex;flex-direction:column;
align-items:center;padding:20px;
}
button{padding:12px 20px;border-radius:14px;border:1px solid #333;background:#111;color:#fff;font-weight:800;cursor:pointer}
button:disabled{opacity:.4}
input[type=range]{width:280px}
#freq{font-size:72px;font-weight:900;margin:10px 0;color:var(--accent)}
#band{font-weight:900;color:var(--accent)}
.modeBtn.active{border-color:var(--accent)}
.whiteMode{--accent:#ffffff}
.pinkMode{--accent:#ff6ec7}
#brandTop{background:none;border:none;color:#fff;font-weight:900;text-decoration:underline;cursor:pointer;margin-bottom:10px}
</style>
</head>
<body>

<button id="brandTop">youtube.com/@ProfPetersonBrito</button>

<div id="modeText">Modo: SWEEP</div>
<div id="band">SUBGRAVE</div>
<div id="freq">20 Hz</div>

<div style="margin:10px 0">
<button class="modeBtn active" id="modeSweep">Sweep</button>
<button class="modeBtn" id="modeWhite">Branco</button>
<button class="modeBtn" id="modePink">Rosa</button>
</div>

<button id="startBtn">Iniciar</button>
<button id="stopBtn" disabled>Parar</button>

<div style="margin-top:10px">
Volume<br>
<input id="vol" type="range" min="0" max="1" step="0.001" value="0.08">
</div>

<script>
(()=>{

const fStart=20,fEnd=20000,duration=300;

let ctx=null,gain=null,osc=null,noise=null;
let mode="sweep";

const freqEl=document.getElementById("freq");
const bandEl=document.getElementById("band");
const modeText=document.getElementById("modeText");
const vol=document.getElementById("vol");
const startBtn=document.getElementById("startBtn");
const stopBtn=document.getElementById("stopBtn");

function ensureCtx(){
if(!ctx)ctx=new (window.AudioContext||window.webkitAudioContext)();
if(!gain){
gain=ctx.createGain();
gain.gain.value=vol.value;
gain.connect(ctx.destination);
}
}

function stopAudio(){
if(osc){try{osc.stop()}catch{} osc=null;}
if(noise){try{noise.stop()}catch{} noise=null;}
startBtn.disabled=false;
stopBtn.disabled=true;
}

function startSweep(){
ensureCtx();
osc=ctx.createOscillator();
osc.type="sine";
osc.connect(gain);
osc.frequency.setValueAtTime(fStart,ctx.currentTime);
osc.frequency.exponentialRampToValueAtTime(fEnd,ctx.currentTime+duration);
osc.start();
osc.stop(ctx.currentTime+duration);
startBtn.disabled=true;
stopBtn.disabled=false;
}

function startNoise(){
ensureCtx();
noise=ctx.createBufferSource();
const buffer=ctx.createBuffer(1,ctx.sampleRate*2,ctx.sampleRate);
const data=buffer.getChannelData(0);
for(let i=0;i<data.length;i++){
data[i]=(Math.random()*2-1)*0.6;
}
noise.buffer=buffer;
noise.loop=true;
noise.connect(gain);
noise.start();
startBtn.disabled=true;
stopBtn.disabled=false;
}

startBtn.addEventListener("click",()=>{
ctx?.resume();
if(mode==="sweep")startSweep();
else startNoise();
});

stopBtn.addEventListener("click",stopAudio);

vol.addEventListener("input",()=>{
if(gain)gain.gain.value=vol.value;
});

function setMode(m){
mode=m;
document.body.classList.remove("whiteMode","pinkMode");
document.querySelectorAll(".modeBtn").forEach(b=>b.classList.remove("active"));

if(m==="white"){
document.body.classList.add("whiteMode");
modeText.textContent="Modo: RUÍDO BRANCO";
document.getElementById("modeWhite").classList.add("active");
}
else if(m==="pink"){
document.body.classList.add("pinkMode");
modeText.textContent="Modo: RUÍDO ROSA";
document.getElementById("modePink").classList.add("active");
}
else{
modeText.textContent="Modo: SWEEP";
document.getElementById("modeSweep").classList.add("active");
}
}

document.getElementById("modeSweep").onclick=()=>setMode("sweep");
document.getElementById("modeWhite").onclick=()=>setMode("white");
document.getElementById("modePink").onclick=()=>setMode("pink");

document.getElementById("brandTop").addEventListener("click",()=>{
const choice=prompt("1 = App\n2 = Navegador","1");
const web="https://www.youtube.com/@ProfPetersonBrito";
const app="youtube://www.youtube.com/@ProfPetersonBrito";
if(choice==="1"){
window.location.href=app;
setTimeout(()=>window.open(web,"_blank"),800);
}else{
window.open(web,"_blank");
}
});

})();
</script>

</body>
</html>
